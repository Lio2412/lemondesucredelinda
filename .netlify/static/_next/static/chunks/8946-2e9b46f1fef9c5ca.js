(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8946],{98946:function(e,t,r){Promise.resolve().then(r.bind(r,19816)),Promise.resolve().then(r.t.bind(r,231,23))},19816:function(e,t,r){"use strict";r.d(t,{CreationForm:function(){return N}});var n=r(57437),i=r(31014),a=r(39343),o=r(59772),s=r(16463),l=r(2265),d=r(30311),c=r(66648),u=r(50495),f=r(32653),m=r(83102),p=r(93146),g=r(63322),x=r(19573),h=r(58184),v=r(24241),b=r(56343),y=r(18615),j=r(37440);let w=o.Ry({title:o.Z_().min(3,{message:"Le titre doit contenir au moins 3 caract\xe8res."}),description:o.Z_().optional(),imageUrl:o.Z_().url({message:"Veuillez entrer une URL d'image valide."}).optional().or(o.Yj()),creationDate:o.hT({required_error:"Une date de cr\xe9ation est requise."})});function N(e){let{initialData:t,creationId:r,onSubmitSuccess:o}=e,N=(0,s.useRouter)(),{toast:_}=(0,d.pm)(),[T,S]=(0,l.useState)("string"==typeof(null==t?void 0:t.imageUrl)?t.imageUrl:null),[D,I]=(0,l.useState)(!1),U=(0,a.cI)({resolver:(0,i.F)(w),defaultValues:{title:(null==t?void 0:t.title)||"",description:(null==t?void 0:t.description)||"",imageUrl:(null==t?void 0:t.imageUrl)||void 0,creationDate:(null==t?void 0:t.creationDate)||new Date}}),E=e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){let e=new FileReader;e.onloadend=()=>{S(e.result)},e.readAsDataURL(r),U.setValue("imageUrl",r)}else S(null),U.setValue("imageUrl",void 0)},z=async e=>{let t;I(!0);let n=r?"PUT":"POST",i=r?"/api/creations/".concat(r):"/api/creations";try{if("PUT"===n){if(e.imageUrl instanceof File){let r=new FormData;r.append("title",e.title),r.append("description",e.description||""),r.append("image",e.imageUrl,e.imageUrl.name),t=await fetch(i,{method:"PUT",body:r})}else{let r={title:e.title,description:e.description};t=await fetch(i,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}}else{let r=new FormData;r.append("title",e.title),r.append("description",e.description||""),e.imageUrl instanceof File&&r.append("image",e.imageUrl,e.imageUrl.name),t=await fetch(i,{method:"POST",body:r})}if(!t.ok){let e=await t.json().catch(()=>({message:"Erreur inconnue lors de la requ\xeate."}));throw Error(e.message||"HTTP error! status: ".concat(t.status))}await t.json(),r&&t.ok?_({title:"Succ\xe8s",description:"✅ Cr\xe9ation mise \xe0 jour avec succ\xe8s !"}):!r&&t.ok&&_({title:"Succ\xe8s",description:"Cr\xe9ation enregistr\xe9e avec succ\xe8s."}),o?o():(N.push("/admin/creations"),N.refresh())}catch(n){console.error("Erreur lors de l'envoi du formulaire:",n);let e=n instanceof Error?n.message:"Une erreur est survenue.",t=r?"de la mise \xe0 jour":"de l'enregistrement";_({title:"Erreur ❌",description:"\xc9chec ".concat(t," : ").concat(e)})}finally{I(!1)}};return(0,n.jsx)(f.l0,{...U,children:(0,n.jsxs)("form",{onSubmit:U.handleSubmit(z),className:"space-y-8",children:[(0,n.jsx)(f.Wi,{control:U.control,name:"title",render:e=>{let{field:t}=e;return(0,n.jsxs)(f.xJ,{children:[(0,n.jsx)(f.lX,{children:"Titre de la cr\xe9ation *"}),(0,n.jsx)(f.NI,{children:(0,n.jsx)(m.I,{placeholder:"Ex: Tarte Tatin revisit\xe9e",...t,disabled:D})}),(0,n.jsx)(f.zG,{})]})}}),(0,n.jsx)(f.Wi,{control:U.control,name:"description",render:e=>{let{field:t}=e;return(0,n.jsxs)(f.xJ,{children:[(0,n.jsx)(f.lX,{children:"Description courte"}),(0,n.jsx)(f.NI,{children:(0,n.jsx)(p.g,{placeholder:"D\xe9crivez bri\xe8vement votre cr\xe9ation...",className:"resize-none",...t,disabled:D})}),(0,n.jsx)(f.zG,{})]})}}),(0,n.jsx)(f.Wi,{control:U.control,name:"imageUrl",render:e=>{let{field:t}=e;return(0,n.jsxs)(f.xJ,{children:[(0,n.jsx)(f.lX,{children:"Image"}),(0,n.jsx)(f.NI,{children:(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(m.I,{id:"picture",type:"file",accept:"image/*",onChange:E,className:"hidden",disabled:D}),(0,n.jsxs)("label",{htmlFor:"picture",className:(0,j.cn)("cursor-pointer inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50","border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2",D&&"opacity-50 cursor-not-allowed"),children:[(0,n.jsx)(h.Z,{className:"mr-2 h-4 w-4"}),"Choisir une image"]}),T&&(0,n.jsx)("div",{className:"relative h-20 w-20 rounded border",children:(0,n.jsx)(c.default,{src:T,alt:"Aper\xe7u",fill:!0,style:{objectFit:"cover"},className:"rounded"})})]})}),(0,n.jsx)(f.pf,{children:"Chargez une image ou collez une URL (l'upload n'est pas g\xe9r\xe9 pour la modification, l'URL n'est pas g\xe9r\xe9e pour la cr\xe9ation via FormData)."}),(0,n.jsx)(f.zG,{})]})}}),(0,n.jsx)(f.Wi,{control:U.control,name:"creationDate",render:e=>{let{field:t}=e;return(0,n.jsxs)(f.xJ,{className:"flex flex-col",children:[(0,n.jsx)(f.lX,{children:"Date de cr\xe9ation *"}),(0,n.jsxs)(x.J2,{children:[(0,n.jsx)(x.xo,{asChild:!0,children:(0,n.jsx)(f.NI,{children:(0,n.jsxs)(u.z,{variant:"outline",className:(0,j.cn)("w-[240px] pl-3 text-left font-normal",!t.value&&"text-muted-foreground"),disabled:D,children:[t.value?(0,b.WU)(t.value,"PPP",{locale:y.fr}):(0,n.jsx)("span",{children:"Choisir une date"}),(0,n.jsx)(v.Z,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,n.jsx)(x.yk,{className:"w-auto p-0",align:"start",children:(0,n.jsx)(g.f,{mode:"single",selected:t.value,onSelect:t.onChange,disabled:e=>e>new Date||e<new Date("1900-01-01")||D,initialFocus:!0,locale:y.fr})})]}),(0,n.jsx)(f.zG,{})]})}}),(0,n.jsxs)(u.z,{type:"submit",disabled:D,className:"w-full sm:w-auto",children:[" ",D?r?"Mise \xe0 jour...":"Enregistrement...":r?"\uD83D\uDCBE Enregistrer les modifications":"Cr\xe9er la cr\xe9ation"]})]})})}},50495:function(e,t,r){"use strict";r.d(t,{d:function(){return l},z:function(){return d}});var n=r(57437),i=r(2265),a=r(71538),o=r(13027),s=r(37440);let l=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=i.forwardRef((e,t)=>{let{className:r,variant:i,size:o,asChild:d=!1,...c}=e,u=d?a.g7:"button";return(0,n.jsx)(u,{className:(0,s.cn)(l({variant:i,size:o,className:r})),ref:t,...c})});d.displayName="Button"},63322:function(e,t,r){"use strict";r.d(t,{f:function(){return l}});var n=r(57437);r(2265);var i=r(47181),a=r(18615),o=r(37440),s=r(50495);function l(e){let{className:t,classNames:r,showOutsideDays:l=!0,...d}=e;return(0,n.jsx)(i._,{locale:a.fr,showOutsideDays:l,className:(0,o.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,o.cn)((0,s.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,o.cn)((0,s.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"text-muted-foreground opacity-50",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},...d})}l.displayName="Calendar"},32653:function(e,t,r){"use strict";r.d(t,{NI:function(){return x},Wi:function(){return u},l0:function(){return d},lX:function(){return g},pf:function(){return h},xJ:function(){return p},zG:function(){return v}});var n=r(57437),i=r(2265),a=r(71538),o=r(39343),s=r(37440),l=r(67135);let d=o.RV,c=i.createContext({}),u=e=>{let{...t}=e;return(0,n.jsx)(c.Provider,{value:{name:t.name},children:(0,n.jsx)(o.Qr,{...t})})},f=()=>{let e=i.useContext(c),t=i.useContext(m),{getFieldState:r,formState:n}=(0,o.Gc)(),a=r(e.name,n);if(!e)throw Error("useFormField should be used within <FormField>");let{id:s}=t;return{id:s,name:e.name,formItemId:"".concat(s,"-form-item"),formDescriptionId:"".concat(s,"-form-item-description"),formMessageId:"".concat(s,"-form-item-message"),...a}},m=i.createContext({}),p=i.forwardRef((e,t)=>{let{className:r,...a}=e,o=i.useId();return(0,n.jsx)(m.Provider,{value:{id:o},children:(0,n.jsx)("div",{ref:t,className:(0,s.cn)("space-y-2",r),...a})})});p.displayName="FormItem";let g=i.forwardRef((e,t)=>{let{className:r,...i}=e,{error:a,formItemId:o}=f();return(0,n.jsx)(l._,{ref:t,className:(0,s.cn)(a&&"text-destructive",r),htmlFor:o,...i})});g.displayName="FormLabel";let x=i.forwardRef((e,t)=>{let{...r}=e,{error:i,formItemId:o,formDescriptionId:s,formMessageId:l}=f();return(0,n.jsx)(a.g7,{ref:t,id:o,"aria-describedby":i?"".concat(s," ").concat(l):"".concat(s),"aria-invalid":!!i,...r})});x.displayName="FormControl";let h=i.forwardRef((e,t)=>{let{className:r,...i}=e,{formDescriptionId:a}=f();return(0,n.jsx)("p",{ref:t,id:a,className:(0,s.cn)("text-[0.8rem] text-muted-foreground",r),...i})});h.displayName="FormDescription";let v=i.forwardRef((e,t)=>{var r;let{className:i,children:a,...o}=e,{error:l,formMessageId:d}=f(),c=l?String(null!==(r=null==l?void 0:l.message)&&void 0!==r?r:""):a;return c?(0,n.jsx)("p",{ref:t,id:d,className:(0,s.cn)("text-[0.8rem] font-medium text-destructive",i),...o,children:c}):null});v.displayName="FormMessage"},83102:function(e,t,r){"use strict";r.d(t,{I:function(){return o}});var n=r(57437),i=r(2265),a=r(37440);let o=i.forwardRef((e,t)=>{let{className:r,type:i,...o}=e;return(0,n.jsx)("input",{type:i,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...o})});o.displayName="Input"},67135:function(e,t,r){"use strict";r.d(t,{_:function(){return d}});var n=r(57437),i=r(2265),a=r(38364),o=r(13027),s=r(37440);let l=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,n.jsx)(a.f,{ref:t,className:(0,s.cn)(l(),r),...i})});d.displayName=a.f.displayName},19573:function(e,t,r){"use strict";r.d(t,{J2:function(){return s},xo:function(){return l},yk:function(){return d}});var n=r(57437),i=r(2265),a=r(61485),o=r(37440);let s=a.fC,l=a.xz;a.ee;let d=i.forwardRef((e,t)=>{let{className:r,align:i="center",sideOffset:s=4,...l}=e;return(0,n.jsx)(a.h_,{children:(0,n.jsx)(a.VY,{ref:t,align:i,sideOffset:s,className:(0,o.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",r),...l})})});d.displayName=a.VY.displayName},93146:function(e,t,r){"use strict";r.d(t,{g:function(){return o}});var n=r(57437),i=r(2265),a=r(37440);let o=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,n.jsx)("textarea",{className:(0,a.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...i})});o.displayName="Textarea"},30311:function(e,t,r){"use strict";r.d(t,{Am:function(){return u},pm:function(){return f}});var n=r(2265);let i=0,a=new Map,o=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},s=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?o(r):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=s(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(i=(i+1)%Number.MAX_SAFE_INTEGER).toString(),n=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||n()}}}),{id:r,dismiss:n,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=n.useState(d);return n.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},37440:function(e,t,r){"use strict";r.d(t,{cn:function(){return a},p:function(){return o}});var n=r(44839),i=r(96164);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.m6)((0,n.W)(t))}function o(e){if(!e)return"";let t="string"==typeof e?new Date(e):e;if(isNaN(t.getTime()))return"";try{return t.toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})}catch(t){return console.error("Erreur lors du formatage de la date:",e,t),""}}},58184:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(78030).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},66648:function(e,t,r){"use strict";r.d(t,{default:function(){return i.a}});var n=r(55601),i=r.n(n)},55601:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return l},getImageProps:function(){return s}});let n=r(99920),i=r(80497),a=r(38173),o=n._(r(21241));function s(e){let{props:t}=(0,i.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let l=a.Image}}]);